---
import BaseLayout from '../layouts/BaseLayout.astro';

const allPosts = await Astro.glob('../pages/posts/*.md');
const posts = allPosts.sort((a, b) => {
	const dateA = new Date(a.frontmatter.pubDate);
	const dateB = new Date(b.frontmatter.pubDate);
	return dateB.getTime() - dateA.getTime();
});

const pageTitle = "My Blog";
---

<BaseLayout title={pageTitle}>
	<h1>My Strange Journey</h1>
	
	<div class="posts-grid">
		{posts.map((post) => (
			<a href={post.url} class="post-card">
				{post.frontmatter.image && (
					<img 
						src={post.frontmatter.image.url} 
						alt={post.frontmatter.image.alt}
						class="post-image"
					/>
				)}
				<div class="post-content">
					<h2>{post.frontmatter.title}</h2>
					<p class="post-description">{post.frontmatter.description}</p>
					<div class="post-meta">
						<time datetime={post.frontmatter.pubDate}>
							{new Date(post.frontmatter.pubDate).toLocaleDateString('en-US', {
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							})}
						</time>
						{post.frontmatter.tags && (
							<div class="post-tags">
								{post.frontmatter.tags.map((tag) => (
									<span class="tag">{tag}</span>
								))}
							</div>
						)}
					</div>
				</div>
			</a>
		))}
	</div>
</BaseLayout>
